<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Объявления</title>
     <!-- Подключение Bootstrap CSS -->
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
     integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link type = "text/css" rel = "stylesheet" href = "stile.css">
</head>
    <style>
      
        body {
            background-color:white;
             display: inline-block;
             padding: 100px;
            margin: 0; 
            padding-top: 60px;
            text-align: center;
            justify-content: center;
        }
        

        h4 {
            color: #000;
            text-align: center;
        }
        .list-group-item {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 80px; 
        border: none;
    }

        .list-group-item:hover {
            background-color: #c3c5c7;
            color: white;
        }

        .list-group-item a {
            color: #000;
            text-decoration: none;
        }

        

    .list-group-item img {
        margin-right: 10px; 
    }
      
      
        #carouselExampleIndicators
    {
        margin: 30px auto; 
        max-width: 80%; 
    }

    .carousel-inner img {
        width: 100%; 
        height: auto; 
    }

    
    .categories-container {
            position: fixed;
            top: 20px; 
            left: 0;
            width: 200px; 
            background-color: #fff;
            border: 1px solid #ddd;
            padding: 10px;
            z-index: 1000;
            
        }
       


       
        h1, label {
            font-size: 25px; 
            color: white; 
        }











       






		
		label {
			display: block;
			margin-bottom: 10px;
            color:#000;
            font-size: smaller;
		}
		input[type="text"] {
			width: 100%;
			padding: 10px;
			border: 1px solid #ccc;
			border-radius: 4px;
			margin-bottom: 20px;
			box-sizing: border-box;
		}
		input[type="submit"] {
			background-color: #333;
			color: #fff;
			padding: 10px 20px;
			border: none;
			border-radius: 4px;
			cursor: pointer;
		}
		input[type="submit"]:hover {
			background-color: #555;
		}



        .form-group {
           
           margin: 10px 4px;
       }

       .form-group label {
           display: block;
       }

       .error {
           color: red;
           display: none;
       }

       .invalid {
           border: red 1px solid;
       }

       .valid {
           border: green 1px solid;
       }













.task-list {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
    margin-top: 20px;
    margin-left: 100px;
  
}

.task {
    border: 1px solid #ccc;
    padding: 10px;
    margin: 10px;
    width: 200px;
    background-color: #f8f9fa;
}

.task p {
    margin: 0;
}

.task img {
    max-width: 100%;
    max-height: 100px;
    margin-top: 10px;
}

.task button {
    background-color: #dc3545;
    color: white;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
    margin-top: 10px;
}

.task button:hover {
    background-color: #bd2130; 
}


    </style>
</head>
<body>

<aside> 
    <img src="img/бабочка.jpg" style="width: 500px; height: 500px; position:fixed; top: 0px; right: 0; transform: translate(0, -50%);margin-top: 300px;">
    </aside>



<main >
   

    <h1 style="	color: #333;
    font-size: 24px;
    margin-bottom: 20px;margin-top: 50px; margin-left: 500px;font-family: cursive; text-align: center;">Добавление объявления</h1>


	<form style="  margin-left: 350px;margin-top: 0px;
    background-color: #b3b2b2;
    border: 1px solid #ccc;
    padding: 10px;
    width: 500px;">
    


        <div class="form-group">
            <label for="title">Название товара:</label>
            <input type="text" id="title" name="title" data-val="true" data-required="Введите имя"
                data-pattern="^[А-Яа-яЁё\s]+$" data-error-label="nameErrorLabel">
            <span class="error" id="nameErrorLabel">Ошибка</span>
        </div>


        <div class="form-group">
            <label for="description">Описание товара:</label>
            <textarea id="description" name="description" rows="5" required></textarea>
        </div>


        <div class="form-group">
            <label for="price">Цена:</label>
            <input type="text" id="price" name="price"  data-required="Введите цену"  data-pattern="^\d+(\.\d{1,2})?$" data-positive-number   data-error-label="priceErrorLabel">
            <span class="error" id="priceErrorLabel">Ошибка</span>
        </div>


      
<div class="form-group">
    <label for="phone">Телефон:</label><br>
    <input type="tel" id="phone" name="phone" placeholder="+1-234-567-8901"
        pattern="\+\d-\d{3}-\d{3}-\d{4}" data-val="true" data-required="Введите телефон"
        data-error-label="phoneErrorLabel">
    <span class="error" id="phoneErrorLabel">Ошибка</span>
  </div>
  
  




        <div class="form-group">
            <label for="category">Категория:</label>
		   <select id="category" name="category">
			<option value="electronics">Техника</option>
            <option value="shoes">Обувь</option>
            <option value="cosmetics">Косметика</option>
			<option value="clothing">Одежда</option>
		    <option value="bijouterie">Украшения</option>
           </select>
           <span class="error" id="categoryErrorLabel">Ошибка</span>

        </div>




        <div class="form-group">
            <label for="photo">Фото:</label>
            <input type="file" id="photo" name="photo" accept="image/*" required>
        </div>

        <div class="form-group">
            <input type="submit" value="Добавить">
        </div>
        
   


 
	</form>

    
<div class="listadv" style="text-align: center;">
    <div class="input-panel">
        <button id="show-all-btn" onclick="showAllHandler()">Все</button>
        <button id="show-not-completed-btn" onclick="showNotCompletedHandler()">Не проданые</button>
    </div>
    
    <div class="task-list">
        <p id="start-message">Нет новых товаров</p>
    </div>
    
    <button id="clear-history-btn" onclick="clearHistoryHandler()">Очистить историю</button>

</div>
    

</main>


<header>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
<div class="container" >
    
    <a class="navbar-brand" href="AdsBoard.html">
        <img src="img/photo_2024-01-16_00-22-10.jpg" alt="Логотип" width="60" height="60" class="d-inline-block align-top">
       AD'S BOARD
    </a>
    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

     <form class="d-flex">
        <input class="form-control me-2" type="search" placeholder="Текст для поиска" aria-label="Search">
       <button class="btn btn-primary" type="submit" style="background-color: #000;">Поиск</button>
     </form>

    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ml-auto">
            <li class="nav-item">
                <a class="nav-link" href="NewAdd.html">
                    &#43;New ad</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="RegistrAvatar.html">My profile</a>
                
                <img src="img/gentle-on-the-caress-clipart-18.jpg"
                width="40">
            </li>
        </ul>
    </div>
    
</div>
</nav>




<nav class="col-md-2  d-md-block bg-light ">
    <div class="categories-container">
     <div class="container mt-5" >
        <div class="row">
         
            
           
                <h4 style="padding-top: 30px;font-family: cursive;">Категории</h4>
        
                    <div class="col">
                       <li class="list-group-item">
                        <a href="index.html">	&#9829; Главная &#9829;</a></li>
                    </div>
          
              
                    <div class="col">
                        <li class="list-group-item"> 
                         <a href="Technica/StrTechnica.html"><img src="img/pngtree-vector-laptop-icon-png-image_4151211.jpg" width="40">Техника</a></li>
                     </div>
                
    
                <div class="col">
                   <li class="list-group-item"> 
                    <a href="Shoes/StrShoes.html"><img src="img/png-clipart-organic-food-computer-icons-resource-shared-resource-food-monochrome.png" width="40">Обувь</a></li>
                </div>
             
            
           
             
                <div class="col">
                    <li class="list-group-item">  
                        <a href="Cosmetics/StrCosmetics.html"> <img src="img/OIP.jpg" width="40">Косметика</a></li>
                </div>

                <div class="col">
                    <li class="list-group-item">
                        <a href="Clothes/StrClothes.html"> <img src="img/photo_2023-12-08_05-52-57.jpg" width="40">Одежда</a></li>
                </div>
               
                <div class="col">
                    <li class="list-group-item">
                                 <a href="Bijouterie/StrBijouterie.html"><img src="img/Колечко.png" width="40">Украшения</a></li>
                     </div>
             </ul>
            

          
           
        </div>
      </div>
    </div>
</nav>

    

<footer class="bg-light text-center py-0 ">
    <div class="container">
        <div class="row">
            <div class="col-md-3 mb-0 mt-4">
                <img src="img/photo_2024-01-16_00-22-10.jpg" width="60">
            </div>
            <div class="col-md-3 mb-0 mt-3">
                <a href="RegistrPay.html">
                    <p class="ml-3"style="color: gray; ">Оплата</p>
                   
                </a>
            </div>
            <div class="col-md-3 mb-0 mt-3">
                <a href="HowBuySell.html">
                    <p class="ml-3"style="color: gray; ">Как продавать и покупать?</p>
                  
                </a>
            </div>
            <div class="col-md-3 mb-0 mt-3">
                <a href="HelpNumber.html">
                    <p class="ml-3"style="color: gray; ">Техподдержка</p>
                 
                </a>
            </div>
        </div>
    </div>
</div>
</footer>

    <!--\ Подключение Bootstrap JS (необходимо для работы некоторых компонентов) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>





<script>
    
   
    const form = document.forms[0];

       
        let elements = document.querySelectorAll("[data-val='true']");

        elements.forEach(element => {
            element.addEventListener("change", onChangeHandler);
        });

        form.addEventListener("submit", onSubmitHandler);

        function onChangeHandler(e) {
            const element = e.target;
            if (element.tagName == "INPUT") {
                validateElement(element);
            }
        }

        function onSubmitHandler(e) {
            for (let i = 0; i < form.elements.length; i++) {
                const element = form.elements[i];
                let valid = validateElement(element);
                if (!valid) {
                    e.preventDefault();
                }
            }
        }

        function validateElement(element) {
            for (const key in validators) {
                if (Object.hasOwnProperty.call(validators, key) && typeof validators[key] == "object") {

                    if (element.dataset[key]) {
                        const validator = validators[key];
                        if (!validator.isValid(element))
                            return false;
                    }
                }
            }

            return true;
        }

        let validators = {};


        validators.validate = function (element, message, predicate) {
            let errorLabel = document.querySelector("#" + element.dataset.errorLabel);
            errorLabel.innerHTML = message;
            errorLabel.style.display = "none";
            element.classList.remove("valid");
            element.classList.remove("invalid");

            if (typeof predicate == "function" && predicate()) {
                element.classList.add("valid");
                return true;
            }
            else {
                element.classList.add("invalid");
                errorLabel.style.display = "block";
                return false;
            }
        };

        validators.required = {
            isValid: function (element) {
                let message = element.dataset.required;
                return validators.validate(element, message, () => element.value.length > 0);
            }
        };

        validators.pattern = {
            isValid: function (element) {
                let message = "Введенное значение не соответствует шаблону";
                let regex = new RegExp(element.dataset.pattern);
                return validators.validate(element, message, () => regex.test(element.value));
            }
        };

        validators.confirm = {
            isValid: function (element) {
                let message = "Значения не совпадают";
                let confirmInput = document.querySelector("#" + element.dataset.confirm);
                return validators.validate(element, message, () => element.value == confirmInput.value);
            }
        };



validators.positiveNumber = {
    isValid: function (element) {
        let message = "Введите положительное число";
        return validators.validate(element, message, () => parseFloat(element.value) > 0);
    }
};








        
        
        
        
        
class Task {
            constructor(title, description, price, phone, category, photo) {
                this.title = title;
                this.description = description;
                this.price = price;
                this.phone = phone;
                this.category = category;
                this.photo = photo;
                this.isDone = false;
            }

            delete() {
            this.isDone = true;
            for (let i = 0; i < dataService.tasks.length; i++) {
            if (dataService.tasks[i] === this) {
             dataService.tasks.splice(i, 1);
             break;
            }
             }
         }
        }

        let dataService = {
            tasks: [],

            get allTasks() {
                return this.tasks;
            },

            get notCompletedTasks() {
                return this.tasks.filter(task => !task.isDone);
            },

            add(task) {
                this.tasks.push(task);
                this.save();
            },
            //Сериализация и десериализация пара 15.12.23
            save() {
                localStorage.setItem("tasks", JSON.stringify(this.tasks));
            },

            open() {
                this.tasks = JSON.parse(localStorage.getItem("tasks")) || [];
            }
            
          
        
        }

        
        class TasksListView {
            element;

            constructor(element) {
                this.element = element;
            }

            #drawList(tasksElements) {
                this.element.innerHTML = "";

                tasksElements.forEach(taskElement => {
                    if (!taskElement.task.isDone) {
                        taskElement.createIn(this.element);
                    }
                });
            }

            drawAll() {
                let taskElements = [];
                let tasks = dataService.allTasks;
                if (tasks.length === 0) return;

                tasks.forEach(task => {
                    taskElements.push(new TaskView(task))
                });
                this.#drawList(taskElements);
            }


           

            drawNotCompleted() {
                let taskElements = [];
                let tasks = dataService.notCompletedTasks;
                if (tasks.length === 0) return;

                tasks.forEach(task => {
                    taskElements.push(new TaskView(task))
                });
                this.#drawList(taskElements);
            }
        }

        class TaskView {
            constructor(task) {
                this.task = task;
                this.div = null;
            }

            createIn(element) {
                this.div = document.createElement("div");
                this.div.classList.add("task");

                let p = document.createElement("p");
                p.innerHTML = `<strong>${this.task.title}</strong><br>
                                Описание: ${this.task.description}<br>
                                Цена: ${this.task.price}<br>
                                Телефон: ${this.task.phone}<br>
                                Категория: ${this.task.category}<br>
                                <img src="${this.task.photo}" alt="Advertisement Photo" style="max-width: 100px; max-height: 100px;">`;

                this.div.append(p);
                
  

                let deleteButton = document.createElement("button");
                
    deleteButton.textContent = "Удалить";
    deleteButton.addEventListener("click", () => deleteTaskHandler(this.task));
    
    this.div.appendChild(deleteButton);

                element.append(this.div);
            }
        }

        let taskNameInput = document.querySelector("#title");
        let priceInput=document.querySelector("#price");
        let phoneInput= document.querySelector("#phone");
        
        let addTaskButton = document.querySelector("input[type='submit']");
        let startMessage = document.querySelector("#start-message");
        let showAllButton = document.querySelector("#show-all-btn");
        let showNotCompletedButton = document.querySelector("#show-not-completed-btn");
        let taskList = document.querySelector(".task-list");

        dataService.open();
        let tasksListView = new TasksListView(taskList);

        addTaskButton.addEventListener("click", addTaskHandler);
        showAllButton.addEventListener("click", showAllHandler);
        showNotCompletedButton.addEventListener("click", showNotCompletedHandler);

            
       window.addEventListener("load", function () {
       dataService.open(); 
       tasksListView.drawAll();
       });
    
        taskNameInput.addEventListener("keydown", function (e) {
            if (e.code == "Enter") addTaskHandler();
        })
    
        priceInput.addEventListener("keydown", function (e) {
            if (e.code == "Enter") addTaskHandler();
        })
        phoneInput.addEventListener("keydown", function (e) {
            if (e.code == "Enter") addTaskHandler();
        })

        function addTaskHandler() {
    if (!startMessage.hidden) startMessage.hidden = true;

    
    const isValidTitle = validateElement(taskNameInput);
    const isValidDescription = validateElement(document.querySelector("#description"));
    const isValidPrice = validateElement(priceInput);
    const isValidPhone = validateElement(phoneInput);
    const isValidCategory = validateElement(document.querySelector("#category"));
    const isValidPhoto = validateElement(document.querySelector("#photo"));

   
    if (isValidTitle && isValidDescription && isValidPrice && isValidPhone && isValidCategory && isValidPhoto) {
        let newTask = new Task(
            taskNameInput.value,
            document.querySelector("#description").value,
            priceInput.value,
            phoneInput.value,
             document.querySelector("#category").value,
            document.querySelector("#photo").value
        );

        dataService.add(newTask);
        tasksListView.drawAll();

        let taskList = document.querySelector(".task-list");
        taskList.innerHTML = "";

        
let taskView = new TaskView(newTask);
taskView.createIn(taskList);




taskNameInput.value = "";

    } else {
       
        alert("Форма содержит ошибки. Пожалуйста, проверьте все поля.");
    }
}



        function showAllHandler() {
            tasksListView.drawAll();
        }

        function showNotCompletedHandler() {
            tasksListView.drawNotCompleted();
        }

      function deleteTaskHandler(task) {
task.delete();
dataService.save();
tasksListView.drawAll();

}


        function clearHistoryHandler() {
            if (confirm("Вы уверены, что хотите очистить историю?")) {
                dataService.tasks = [];
                dataService.save();
                tasksListView.drawAll();
                alert("История успешно очищена.");
            }
        }

       
       





 </script>
</body>
</html>
